import { InjectionToken, inject } from '@angular/core';
import { createFeature, } from './features';
export const NgIconPreProcessorToken = new InjectionToken('Ng Icon Pre Processor');
export const NgIconPostProcessorToken = new InjectionToken('Ng Icon Post Processor');
export function injectNgIconPreProcessor() {
    return inject(NgIconPreProcessorToken, { optional: true }) ?? (icon => icon);
}
export function injectNgIconPostProcessor() {
    return inject(NgIconPostProcessorToken, { optional: true }) ?? (() => { });
}
function preprocessIcon(icon) {
    // rename all style attributes to data-style to avoid being blocked by the CSP
    return icon.replace(/style\s*=/g, 'data-style=');
}
function postprocessIcon(element) {
    // find all elements with a data-style attribute and get the styles from it
    // and apply them to the element using the style property and remove the data-style attribute
    const elements = element.querySelectorAll('[data-style]');
    for (const element of Array.from(elements)) {
        const styles = element.getAttribute('data-style');
        styles?.split(';').forEach(style => {
            const [property, value] = style.split(':');
            element.style[property.trim()] = value.trim();
        });
        element.removeAttribute('data-style');
    }
}
/**
 * Process icons in a way that is compliant with the content security policy
 */
export function withContentSecurityPolicy() {
    return createFeature(0 /* NgIconFeatureKind.ContentSecurityPolicyFeature */, [
        { provide: NgIconPreProcessorToken, useValue: preprocessIcon },
        { provide: NgIconPostProcessorToken, useValue: postprocessIcon },
    ]);
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY3NwLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vLi4vLi4vcGFja2FnZXMvY29yZS9zcmMvbGliL3Byb3ZpZGVycy9mZWF0dXJlcy9jc3AudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLGNBQWMsRUFBRSxNQUFNLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDdkQsT0FBTyxFQUdMLGFBQWEsR0FDZCxNQUFNLFlBQVksQ0FBQztBQUtwQixNQUFNLENBQUMsTUFBTSx1QkFBdUIsR0FBRyxJQUFJLGNBQWMsQ0FDdkQsdUJBQXVCLENBQ3hCLENBQUM7QUFFRixNQUFNLENBQUMsTUFBTSx3QkFBd0IsR0FBRyxJQUFJLGNBQWMsQ0FDeEQsd0JBQXdCLENBQ3pCLENBQUM7QUFFRixNQUFNLFVBQVUsd0JBQXdCO0lBQ3RDLE9BQU8sTUFBTSxDQUFDLHVCQUF1QixFQUFFLEVBQUUsUUFBUSxFQUFFLElBQUksRUFBRSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLElBQUksQ0FBQyxDQUFDO0FBQy9FLENBQUM7QUFFRCxNQUFNLFVBQVUseUJBQXlCO0lBQ3ZDLE9BQU8sTUFBTSxDQUFDLHdCQUF3QixFQUFFLEVBQUUsUUFBUSxFQUFFLElBQUksRUFBRSxDQUFDLElBQUksQ0FBQyxHQUFHLEVBQUUsR0FBRSxDQUFDLENBQUMsQ0FBQztBQUM1RSxDQUFDO0FBRUQsU0FBUyxjQUFjLENBQUMsSUFBWTtJQUNsQyw4RUFBOEU7SUFDOUUsT0FBTyxJQUFJLENBQUMsT0FBTyxDQUFDLFlBQVksRUFBRSxhQUFhLENBQUMsQ0FBQztBQUNuRCxDQUFDO0FBRUQsU0FBUyxlQUFlLENBQUMsT0FBb0I7SUFDM0MsMkVBQTJFO0lBQzNFLDZGQUE2RjtJQUM3RixNQUFNLFFBQVEsR0FBRyxPQUFPLENBQUMsZ0JBQWdCLENBQWMsY0FBYyxDQUFDLENBQUM7SUFFdkUsS0FBSyxNQUFNLE9BQU8sSUFBSSxLQUFLLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxFQUFFLENBQUM7UUFDM0MsTUFBTSxNQUFNLEdBQUcsT0FBTyxDQUFDLFlBQVksQ0FBQyxZQUFZLENBQUMsQ0FBQztRQUVsRCxNQUFNLEVBQUUsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsRUFBRTtZQUNqQyxNQUFNLENBQUMsUUFBUSxFQUFFLEtBQUssQ0FBQyxHQUFHLEtBQUssQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUM7WUFDM0MsT0FBTyxDQUFDLEtBQUssQ0FBQyxRQUFRLENBQUMsSUFBSSxFQUFTLENBQUMsR0FBRyxLQUFLLENBQUMsSUFBSSxFQUFFLENBQUM7UUFDdkQsQ0FBQyxDQUFDLENBQUM7UUFFSCxPQUFPLENBQUMsZUFBZSxDQUFDLFlBQVksQ0FBQyxDQUFDO0lBQ3hDLENBQUM7QUFDSCxDQUFDO0FBRUQ7O0dBRUc7QUFDSCxNQUFNLFVBQVUseUJBQXlCO0lBQ3ZDLE9BQU8sYUFBYSx5REFBaUQ7UUFDbkUsRUFBRSxPQUFPLEVBQUUsdUJBQXVCLEVBQUUsUUFBUSxFQUFFLGNBQWMsRUFBRTtRQUM5RCxFQUFFLE9BQU8sRUFBRSx3QkFBd0IsRUFBRSxRQUFRLEVBQUUsZUFBZSxFQUFFO0tBQ2pFLENBQUMsQ0FBQztBQUNMLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBJbmplY3Rpb25Ub2tlbiwgaW5qZWN0IH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQge1xuICBDb250ZW50U2VjdXJpdHlQb2xpY3lGZWF0dXJlLFxuICBOZ0ljb25GZWF0dXJlS2luZCxcbiAgY3JlYXRlRmVhdHVyZSxcbn0gZnJvbSAnLi9mZWF0dXJlcyc7XG5cbmV4cG9ydCB0eXBlIE5nSWNvblByZVByb2Nlc3NvciA9IChpY29uOiBzdHJpbmcpID0+IHN0cmluZztcbmV4cG9ydCB0eXBlIE5nSWNvblBvc3RQcm9jZXNzb3IgPSAoZWxlbWVudDogSFRNTEVsZW1lbnQpID0+IHZvaWQ7XG5cbmV4cG9ydCBjb25zdCBOZ0ljb25QcmVQcm9jZXNzb3JUb2tlbiA9IG5ldyBJbmplY3Rpb25Ub2tlbjxOZ0ljb25QcmVQcm9jZXNzb3I+KFxuICAnTmcgSWNvbiBQcmUgUHJvY2Vzc29yJyxcbik7XG5cbmV4cG9ydCBjb25zdCBOZ0ljb25Qb3N0UHJvY2Vzc29yVG9rZW4gPSBuZXcgSW5qZWN0aW9uVG9rZW48TmdJY29uUG9zdFByb2Nlc3Nvcj4oXG4gICdOZyBJY29uIFBvc3QgUHJvY2Vzc29yJyxcbik7XG5cbmV4cG9ydCBmdW5jdGlvbiBpbmplY3ROZ0ljb25QcmVQcm9jZXNzb3IoKTogTmdJY29uUHJlUHJvY2Vzc29yIHtcbiAgcmV0dXJuIGluamVjdChOZ0ljb25QcmVQcm9jZXNzb3JUb2tlbiwgeyBvcHRpb25hbDogdHJ1ZSB9KSA/PyAoaWNvbiA9PiBpY29uKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGluamVjdE5nSWNvblBvc3RQcm9jZXNzb3IoKTogTmdJY29uUG9zdFByb2Nlc3NvciB7XG4gIHJldHVybiBpbmplY3QoTmdJY29uUG9zdFByb2Nlc3NvclRva2VuLCB7IG9wdGlvbmFsOiB0cnVlIH0pID8/ICgoKSA9PiB7fSk7XG59XG5cbmZ1bmN0aW9uIHByZXByb2Nlc3NJY29uKGljb246IHN0cmluZyk6IHN0cmluZyB7XG4gIC8vIHJlbmFtZSBhbGwgc3R5bGUgYXR0cmlidXRlcyB0byBkYXRhLXN0eWxlIHRvIGF2b2lkIGJlaW5nIGJsb2NrZWQgYnkgdGhlIENTUFxuICByZXR1cm4gaWNvbi5yZXBsYWNlKC9zdHlsZVxccyo9L2csICdkYXRhLXN0eWxlPScpO1xufVxuXG5mdW5jdGlvbiBwb3N0cHJvY2Vzc0ljb24oZWxlbWVudDogSFRNTEVsZW1lbnQpOiB2b2lkIHtcbiAgLy8gZmluZCBhbGwgZWxlbWVudHMgd2l0aCBhIGRhdGEtc3R5bGUgYXR0cmlidXRlIGFuZCBnZXQgdGhlIHN0eWxlcyBmcm9tIGl0XG4gIC8vIGFuZCBhcHBseSB0aGVtIHRvIHRoZSBlbGVtZW50IHVzaW5nIHRoZSBzdHlsZSBwcm9wZXJ0eSBhbmQgcmVtb3ZlIHRoZSBkYXRhLXN0eWxlIGF0dHJpYnV0ZVxuICBjb25zdCBlbGVtZW50cyA9IGVsZW1lbnQucXVlcnlTZWxlY3RvckFsbDxIVE1MRWxlbWVudD4oJ1tkYXRhLXN0eWxlXScpO1xuXG4gIGZvciAoY29uc3QgZWxlbWVudCBvZiBBcnJheS5mcm9tKGVsZW1lbnRzKSkge1xuICAgIGNvbnN0IHN0eWxlcyA9IGVsZW1lbnQuZ2V0QXR0cmlidXRlKCdkYXRhLXN0eWxlJyk7XG5cbiAgICBzdHlsZXM/LnNwbGl0KCc7JykuZm9yRWFjaChzdHlsZSA9PiB7XG4gICAgICBjb25zdCBbcHJvcGVydHksIHZhbHVlXSA9IHN0eWxlLnNwbGl0KCc6Jyk7XG4gICAgICBlbGVtZW50LnN0eWxlW3Byb3BlcnR5LnRyaW0oKSBhcyBhbnldID0gdmFsdWUudHJpbSgpO1xuICAgIH0pO1xuXG4gICAgZWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUoJ2RhdGEtc3R5bGUnKTtcbiAgfVxufVxuXG4vKipcbiAqIFByb2Nlc3MgaWNvbnMgaW4gYSB3YXkgdGhhdCBpcyBjb21wbGlhbnQgd2l0aCB0aGUgY29udGVudCBzZWN1cml0eSBwb2xpY3lcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHdpdGhDb250ZW50U2VjdXJpdHlQb2xpY3koKTogQ29udGVudFNlY3VyaXR5UG9saWN5RmVhdHVyZSB7XG4gIHJldHVybiBjcmVhdGVGZWF0dXJlKE5nSWNvbkZlYXR1cmVLaW5kLkNvbnRlbnRTZWN1cml0eVBvbGljeUZlYXR1cmUsIFtcbiAgICB7IHByb3ZpZGU6IE5nSWNvblByZVByb2Nlc3NvclRva2VuLCB1c2VWYWx1ZTogcHJlcHJvY2Vzc0ljb24gfSxcbiAgICB7IHByb3ZpZGU6IE5nSWNvblBvc3RQcm9jZXNzb3JUb2tlbiwgdXNlVmFsdWU6IHBvc3Rwcm9jZXNzSWNvbiB9LFxuICBdKTtcbn1cbiJdfQ==